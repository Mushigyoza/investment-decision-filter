<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•·æœŸæŠ•è³‡éæ¿¾å™¨</title>
    <style>
        @font-face {
            font-family: 'jf-openhuninn';
            src: url('https://cdn.jsdelivr.net/gh/justfont/open-huninn-font@master/font/jf-openhuninn-1.1/jf-openhuninn-1.1.ttf') format('truetype');
        }

        :root {
            --primary: #5f6c7b; --bg: #f4f1ea; --container-bg: #ffffff;
            --main-btn: #9d8189; --status-over: #e5989b; --status-under: #e6b8a2; --status-good: #84a59d;
            --table-head: #e8e4dc; --border: #e0deda;
        }

        body {
            font-family: 'jf-openhuninn', "Microsoft JhengHei", sans-serif;
            background-color: var(--bg); color: var(--primary);
            margin: 0; padding: 25px 15px; line-height: 1.5;
        }

        .container { 
            max-width: 1000px; margin: 0 auto; background: #fff; 
            padding: 30px; border-radius: 25px; 
            box-shadow: 0 10px 30px rgba(157, 129, 137, 0.1); 
        }

        h1 { text-align: center; color: #6d597a; font-size: 2.2em; margin-bottom: 30px; letter-spacing: 2px; }

        .header-info {
            background: #6d6875; color: #fff; padding: 20px; border-radius: 15px;
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;
        }
        .fx-tag { background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 50px; font-size: 0.85em; }

        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .card { 
            padding: 20px; border-radius: 20px; border: none; 
            background: #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.02);
            border-top: 6px solid #ccc; transition: all 0.3s ease;
        }
        .card.over { border-top-color: var(--status-over); background: #fffafb; }
        .card.under { border-top-color: var(--status-under); background: #fffcfb; }
        .card.good { border-top-color: var(--status-good); background: #f9fbf9; }

        .card h4 { margin: 0 0 10px 0; color: #6d597a; font-size: 1.1em; display: flex; justify-content: space-between; align-items: center; }
        .target-input { 
            width: 50px; border: none; background: #f0edee; border-radius: 6px; 
            padding: 3px; text-align: center; font-family: inherit; font-weight: bold; color: #9d8189;
        }

        .table-container { margin-top: 15px; border-radius: 15px; overflow: hidden; border: 1px solid var(--border); }
        table { width: 100%; border-collapse: collapse; background: #fff; font-size: 0.95em; }
        th { background: var(--table-head); padding: 15px; color: #7d6e6e; font-weight: 600; }
        td { padding: 12px 15px; border-bottom: 1px solid #f8f7f5; }
        
        input[type="number"], input[type="text"], select {
            padding: 8px; border: 1px solid #eee; border-radius: 8px; background: #fafafa;
            font-family: inherit; font-size: 0.95em; color: var(--primary);
        }

        /* å¿ƒç†æª¢æŸ¥ 2:8 æ¯”ä¾‹å€å¡Š */
        #quiz-section { margin-top: 40px; border-top: 2px dashed var(--border); padding-top: 30px; }
        .q-item { margin-bottom: 25px; }
        .q-item p { font-weight: bold; margin-bottom: 12px; font-size: 1.05em; color: #6d597a; }
        
        .option-label {
            display: flex; align-items: center; padding: 18px; margin-bottom: 10px;
            background: #fdfcfb; border: 1px solid #f0edee; border-radius: 15px; cursor: pointer;
            transition: all 0.2s;
        }
        .option-label:hover { background: #fff; border-color: var(--main-btn); }
        
        /* åš´æ ¼åŸ·è¡Œ 2:8 æ¯”ä¾‹ */
        .option-label input[type="radio"] {
            flex: 0 0 20% !important; transform: scale(1.5); accent-color: var(--main-btn); margin: 0 !important;
        }
        .option-label span {
            flex: 0 0 80% !important; padding-left: 15px; font-size: 1.05em; font-weight: 500; line-height: 1.5;
        }

        .btn-main {
            width: 100%; padding: 18px; background: var(--main-btn); color: #fff;
            border: none; border-radius: 15px; font-size: 1.2em; font-weight: bold;
            cursor: pointer; margin-top: 30px;
        }

        #final-result { padding: 25px; border-radius: 15px; margin-top: 25px; font-weight: bold; text-align: center; display: none; font-size: 1.1em; }
        .res-stop { background: #fae1dd; color: #b56576; border: 1px solid #e5989b; }
        .res-go { background: #e6f2ee; color: #4a7c59; border: 1px solid #84a59d; }
    </style>
</head>
<body>

<div class="container">
    <h1>é•·æœŸæŠ•è³‡éæ¿¾å™¨</h1>

    <div class="header-info">
        <div>
            <span style="font-size: 0.85em; opacity: 0.9;">å³æ™‚åŒ¯ç‡ (USD/TWD)</span><br>
            <span class="fx-tag" id="fx-display">è®€å–ä¸­...</span>
        </div>
        <div style="text-align: right;">
            <span style="font-size: 0.85em; opacity: 0.9;">é ä¼°ç¸½è³‡ç”¢ (å°å¹£)</span><br>
            <span id="total-assets" style="font-size: 1.6em; font-weight: bold;">$ 0</span>
        </div>
    </div>

    <div class="dashboard">
        <div class="card" id="card-core">
            <h4>æ ¸å¿ƒ <span><input type="number" id="target-core" class="target-input" value="45" oninput="calc()"> %</span></h4>
            <div id="pct-core" style="font-size: 1.8em; font-weight: bold;">0%</div>
            <div id="amt-core" style="font-size: 0.9em; opacity: 0.7;">$0</div>
            <div id="status-core" style="margin-top: 8px; font-size: 0.85em; font-weight: bold;">--</div>
        </div>
        <div class="card" id="card-global">
            <h4>å…¨çƒ <span><input type="number" id="target-global" class="target-input" value="30" oninput="calc()"> %</span></h4>
            <div id="pct-global" style="font-size: 1.8em; font-weight: bold;">0%</div>
            <div id="amt-global" style="font-size: 0.9em; opacity: 0.7;">$0</div>
            <div id="status-global" style="margin-top: 8px; font-size: 0.85em; font-weight: bold;">--</div>
        </div>
        <div class="card" id="card-tech">
            <h4>ç§‘æŠ€ <span><input type="number" id="target-tech" class="target-input" value="20" oninput="calc()"> %</span></h4>
            <div id="pct-tech" style="font-size: 1.8em; font-weight: bold;">0%</div>
            <div id="amt-tech" style="font-size: 0.9em; opacity: 0.7;">$0</div>
            <div id="status-tech" style="margin-top: 8px; font-size: 0.85em; font-weight: bold;">--</div>
        </div>
        <div class="card" id="card-other">
            <h4>å…¶ä»– <span><input type="number" id="target-other" class="target-input" value="5" oninput="calc()"> %</span></h4>
            <div id="pct-other" style="font-size: 1.8em; font-weight: bold;">0%</div>
            <div id="amt-other" style="font-size: 0.9em; opacity: 0.7;">$0</div>
            <div id="status-other" style="margin-top: 8px; font-size: 0.85em; font-weight: bold;">--</div>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>æŒè‚¡ä»£è™Ÿ</th>
                    <th>è³‡ç”¢é¡åˆ¥</th>
                    <th>è¨ˆåƒ¹å¹£åˆ¥</th>
                    <th>ç›®å‰åº«å­˜</th>
                    <th>æ¬²äº¤æ˜“é‡‘é¡ (+/-)</th>
                    <th>æŠ˜åˆå°å¹£</th>
                </tr>
            </thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>
    
    <button style="width:100%; padding:12px; margin-top:15px; background:none; border:2px dashed var(--border); border-radius:12px; cursor:pointer; font-family:inherit; color:#9d8189; font-size:0.9em;" onclick="addRow()">+ æ–°å¢æŠ•è³‡é …ç›®</button>

    <button class="btn-main" onclick="showQuiz()">é…ç½®å®Œæˆï¼Œé€²å…¥å¿ƒç†æª¢æŸ¥</button>

    <div id="quiz-section" style="display:none;">
        <h3 style="color:#6d597a; margin-bottom:25px; font-size:1.3em;">æœ€å¾Œä¸€æ­¥ï¼šæ±ºç­–å“è³ªæª¢æŸ¥</h3>
        
        <div class="q-item">
            <p>1. é€™å€‹äº¤æ˜“å‹•ä½œçš„ä¸»è¦å‹•æ©Ÿæ˜¯ï¼Ÿ</p>
            <label class="option-label">
                <input type="radio" name="q1" value="pass" onchange="checkResult()">
                <span>ç‚ºäº†è®“è³‡ç”¢æ¯”ä¾‹å›åˆ°ç›®æ¨™å€é–“ (å†å¹³è¡¡)</span>
            </label>
            <label class="option-label">
                <input type="radio" name="q1" value="stop" onchange="checkResult()">
                <span>è¦ºå¾—æŸæ”¯è‚¡ç¥¨è¦æ¼²äº†æƒ³è¿½ï¼Œæˆ–æ˜¯è·Œäº†æƒ³ç  (æƒ…ç·’)</span>
            </label>
        </div>

        <div class="q-item">
            <p>2. å£“åŠ›æ¸¬è©¦ï¼šå¦‚æœäº¤æ˜“å¾Œæ˜å¤©è·Œ 30%...</p>
            <label class="option-label">
                <input type="radio" name="q2" value="pass" onchange="checkResult()">
                <span>æˆ‘é‚„èƒ½ç¡å¾—è‘—ï¼Œç”Ÿæ´»ä¸å—å½±éŸ¿</span>
            </label>
            <label class="option-label">
                <input type="radio" name="q2" value="stop" onchange="checkResult()">
                <span>æˆ‘æœƒéå¸¸ç„¦æ…®ï¼Œç”šè‡³æƒ³åœæ</span>
            </label>
        </div>

        <div class="q-item">
            <p>3. é€™äº›éŒ¢çš„é–’ç½®æ™‚é–“ï¼Ÿ</p>
            <label class="option-label">
                <input type="radio" name="q3" value="pass" onchange="checkResult()">
                <span>10 å¹´ä»¥ä¸Šä¸æœƒç”¨åˆ°</span>
            </label>
            <label class="option-label">
                <input type="radio" name="q3" value="stop" onchange="checkResult()">
                <span>1-2 å¹´å…§å¯èƒ½æœƒæ‹¿ä¾†ç”¨</span>
            </label>
        </div>
    </div>

    <div id="final-result"></div>
</div>

<script>
    let currentRate = 32.5;

    async function fetchExchangeRate() {
        try {
            const response = await fetch('https://open.er-api.com/v6/latest/USD');
            const data = await response.json();
            currentRate = data.rates.TWD;
            document.getElementById('fx-display').innerText = `1 USD = ${currentRate.toFixed(2)} TWD (å³æ™‚)`;
            calc();
        } catch (e) {
            document.getElementById('fx-display').innerText = `1 USD = 32.50 TWD (é è¨­)`;
        }
    }

    function addRow() {
        const tbody = document.getElementById('table-body');
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td><input type="text" placeholder="VOO" style="width:80px"></td>
            <td><select onchange="calc()"><option value="core">æ ¸å¿ƒé…ç½®</option><option value="global">å…¨çƒé…ç½®</option><option value="tech">ç§‘æŠ€é…ç½®</option><option value="other">å…¶ä»–/å€‹è‚¡</option></select></td>
            <td><select class="currency" onchange="calc()"><option value="TWD">å°å¹£</option><option value="USD">ç¾é‡‘</option></select></td>
            <td><input type="number" class="cur-val" value="0" oninput="calc()"></td>
            <td><input type="number" class="trade-val" value="0" oninput="calc()"></td>
            <td class="row-twd" style="font-weight:bold; color:#6d597a;">0</td>
        `;
        tbody.appendChild(tr);
    }

    function calc() {
        let totals = { core: 0, global: 0, tech: 0, other: 0 }, grandTotal = 0;
        document.querySelectorAll('#table-body tr').forEach(row => {
            const cat = row.querySelector('select').value;
            const curr = row.querySelector('.currency').value;
            const curVal = parseFloat(row.querySelector('.cur-val').value) || 0;
            const tradeVal = parseFloat(row.querySelector('.trade-val').value) || 0;
            let rowTWD = (curVal + tradeVal) * (curr === 'USD' ? currentRate : 1);
            row.querySelector('.row-twd').innerText = Math.round(rowTWD).toLocaleString();
            totals[cat] += rowTWD; grandTotal += rowTWD;
        });

        document.getElementById('total-assets').innerText = "$ " + Math.round(grandTotal).toLocaleString();

        ['core', 'global', 'tech', 'other'].forEach(cat => {
            const pct = grandTotal > 0 ? (totals[cat] / grandTotal * 100) : 0;
            const target = parseFloat(document.getElementById('target-' + cat).value) || 0;
            document.getElementById('pct-' + cat).innerText = pct.toFixed(1) + "%";
            document.getElementById('amt-' + cat).innerText = "NT$ " + Math.round(totals[cat]).toLocaleString();
            const card = document.getElementById('card-' + cat);
            const statusEl = document.getElementById('status-' + cat);
            card.className = "card";
            if (pct > target + 5) { statusEl.innerText = "âš ï¸ æ¯”ä¾‹éé‡"; card.classList.add('over'); }
            else if (pct < target - 5) { statusEl.innerText = "ğŸ’¡ å»ºè­°åŠ ç¢¼"; card.classList.add('under'); }
            else { statusEl.innerText = "âœ… ç†æƒ³ç‹€æ…‹"; card.classList.add('good'); }
        });
        checkResult();
    }

    function showQuiz() { 
        document.getElementById('quiz-section').style.display = 'block'; 
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    function checkResult() {
        if (document.getElementById('quiz-section').style.display === 'none') return;
        
        const q1 = document.querySelector('input[name="q1"]:checked')?.value;
        const q2 = document.querySelector('input[name="q2"]:checked')?.value;
        const q3 = document.querySelector('input[name="q3"]:checked')?.value;
        const res = document.getElementById('final-result');

        if (q1 && q2 && q3) {
            res.style.display = 'block';
            if ([q1, q2, q3].includes('stop')) {
                res.className = 'res-stop';
                res.innerText = 'ğŸ›‘ ç·©ç·©å§ï¼šå¿ƒæ…‹æˆ–é¢¨éšªæ‰¿å—åº¦äº®ç´…ç‡ˆï¼Œè«‹å…ˆæš«åœäº¤æ˜“ã€‚';
            } else {
                res.className = 'res-go';
                res.innerText = 'âœ… é€šéï¼šé…ç½®ç†æ€§ä¸”å¿ƒæ…‹å¹³ç©©ï¼Œå¯ä»¥åŸ·è¡Œäº¤æ˜“ã€‚';
            }
        } else {
            res.style.display = 'none';
        }
    }

    window.onload = () => { fetchExchangeRate(); addRow(); addRow(); };
</script>
</body>
</html>
